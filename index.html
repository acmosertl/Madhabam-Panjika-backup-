<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ржорж╛ржзржмржо ржкржЮрзНржЬрж┐ржХрж╛ тАФ vC1.3</title>
<style>
  :root{
    --bg:#fff4e3;
    --card:#fff8ee;
    --pink:#f59ed3;
    --red:#c62828;
    --gold:#ffbf00;
    --deep:#0d2a68;
    --mid:#183a8a;
    --label:#3a237a; /* deep purple labels */
    --text:#2b1b12;
    --shadow:0 8px 24px rgba(0,0,0,.12);
    --round:20px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;background:var(--bg);font-family:"Noto Sans Bengali",system-ui,Segoe UI,Roboto,sans-serif;
    color:var(--text);
  }
  .wrap{max-width:820px;margin:16px auto;padding:8px}
  .card{
    background:var(--card);border-radius:24px;padding:16px 14px;margin:14px 10px;box-shadow:var(--shadow)
  }
  .title{display:flex;align-items:center;gap:8px;justify-content:center;font-weight:800;font-size:22px;margin-bottom:10px}
  /* Panchika grid */
  .grid{display:grid;gap:12px}
  .grid-2{grid-template-columns:1fr 1fr}
  .pill{
    background:var(--pink);border-radius:18px;padding:14px
  }
  .label{color:var(--label);font-weight:800;font-size:18px;margin-bottom:6px}
  .value{font-weight:900;font-size:26px}
  /* Ekadashi card */
  .eka{background:var(--red);color:#fff}
  .eka-name{
    font-weight:900;font-size:36px;color:#ffd54f;
    text-shadow:0 0 12px rgba(255,213,79,.85),0 0 24px rgba(255,213,79,.45);
    text-align:center;line-height:1.05;margin:6px 0 4px
  }
  .eka-meta{opacity:.95;text-align:center;font-size:18px}
  /* Upcoming event card */
  .up{background:#ffe895;color:#b71c1c;text-align:center}
  .up .nm{font-weight:900;font-size:28px}
  .up .dt{margin-top:4px;font-size:18px;font-weight:700}
  /* Tide card */
  .tide{background:linear-gradient(180deg,var(--mid),var(--deep));color:#fff}
  .tide .title{color:#e3f2fd}
  .tideGrid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .tideCell{background:rgba(255,255,255,.08);border-radius:16px;padding:14px;text-align:center;box-shadow:inset 0 0 0 1px rgba(255,255,255,.12)}
  .tideLab{font-weight:800;margin-bottom:4px}
  .tideVal{font-size:20px;font-weight:900}
  /* Calendar trigger */
  .cal{background:#fff7df;text-align:center;font-weight:800}
  .cal a{color:#5e35b1;text-decoration:none}
  /* small helpers */
  .row{display:flex;gap:12px}
  .row>*{flex:1}
</style>
</head>
<body>
<div class="wrap">

  <!-- ржкржЮрзНржЬрж┐ржХрж╛ -->
  <section class="card">
    <div class="title">ЁЯкФ ржкржЮрзНржЬрж┐ржХрж╛</div>

    <!-- рждрж┐ржерж┐ (ржмрзЬ), ржиржХрзНрж╖рждрзНрж░ (ржмрзЬ) -->
    <div class="grid">
      <div class="pill">
        <div class="label">рждрж┐ржерж┐</div>
        <div class="value" id="tithi">тАФ</div>
        <div id="tithiExtra" style="margin-top:6px;font-weight:700;opacity:.9"></div>
      </div>

      <div class="pill">
        <div class="label">ржиржХрзНрж╖рждрзНрж░</div>
        <div class="value" id="nak">тАФ</div>
        <div id="nakExtra" style="margin-top:6px;font-weight:700;opacity:.9"></div>
      </div>
    </div>

    <!-- рж╕рзВрж░рзНржп/ржЪржирзНржжрзНрж░ рж╕ржорзЯ (рж╕ржорж╛ржи ржХрж╛рж░рзНржб) -->
    <div class="grid grid-2" style="margin-top:12px">
      <div class="pill">
        <div class="label">рж╕рзВрж░рзНржпрзЛржжржпрж╝</div>
        <div class="value" id="sunrise">тАФ</div>
      </div>
      <div class="pill">
        <div class="label">рж╕рзВрж░рзНржпрж╛рж╕рзНржд</div>
        <div class="value" id="sunset">тАФ</div>
      </div>
      <div class="pill">
        <div class="label">ржЪржирзНржжрзНрж░рзЛржжржпрж╝</div>
        <div class="value" id="moonrise">тАФ</div>
      </div>
      <div class="pill">
        <div class="label">ржЪржирзНржжрзНрж░рж╛рж╕рзНржд</div>
        <div class="value" id="moonset">тАФ</div>
      </div>
    </div>
  </section>

  <!-- рж╕ржорзНржкрзВрж░рзНржг ржХрзНржпрж╛рж▓рзЗржирзНржбрж╛рж░ ржЯрзНрж░рж┐ржЧрж╛рж░ -->
  <section class="card cal">
    <a href="#madhabam-fullcalendar-popup" id="calendar-trigger">ЁЯУЕ рж╕ржорзНржкрзВрж░рзНржг рж╣рж┐ржирзНржжрзБ ржкржЮрзНржЬрж┐ржХрж╛ ржХрзНржпрж╛рж▓рзЗржирзНржбрж╛рж░ ржжрзЗржЦрзБржи</a>
  </section>

  <!-- ржПржХрж╛ржжрж╢рзА -->
  <section class="card eka">
    <div class="title">ЁЯМ╝ ржкрж░ржмрж░рзНрждрзА ржПржХрж╛ржжрж╢рзА</div>
    <div class="eka-name" id="ekaName">тАФ</div>
    <div class="eka-meta" id="ekaDate">тАФ</div>
    <div class="eka-meta" id="ekaLeft">тАФ ржжрж┐ржи ржмрж╛ржХрж┐</div>
  </section>

  <!-- ржЖрж╕ржирзНржи ржЙрзОрж╕ржм -->
  <section class="card up">
    <div class="nm">ЁЯУг ржЧрзАрждрж╛ ржЬржпрж╝ржирзНрждрзА</div>
    <div class="dt">рзжрзл ржбрж┐рж╕рзЗржорзНржмрж░, рзирзжрзирзл тАв рзйрзз ржжрж┐ржи ржкрж░рзЗ</div>
  </section>

  <!-- ржЬрзЛржпрж╝рж╛рж░-ржнрж╛ржЯрж╛ -->
  <section class="card tide">
    <div class="title">ЁЯМК ржЖржЬржХрзЗрж░ ржЬрзЛржпрж╝рж╛рж░-ржнрж╛ржЯрж╛</div>
    <div class="tideGrid">
      <div class="tideCell"><div class="tideLab">ржЙржЪрзНржЪ ржЬрзЛржпрж╝рж╛рж░ рзз</div><div class="tideVal" id="tide1">тАФ</div></div>
      <div class="tideCell"><div class="tideLab">ржЙржЪрзНржЪ ржЬрзЛржпрж╝рж╛рж░ рзи</div><div class="tideVal" id="tide2">тАФ</div></div>
      <div class="tideCell"><div class="tideLab">ржирж┐ржорзНржи ржнрж╛ржЯрж╛ рзз</div><div class="tideVal" id="tide3">тАФ</div></div>
      <div class="tideCell"><div class="tideLab">ржирж┐ржорзНржи ржнрж╛ржЯрж╛ рзи</div><div class="tideVal" id="tide4">тАФ</div></div>
    </div>
  </section>

</div>

<script>
(async function(){
  const bnDigits = s => String(s).replace(/\d/g, d => "рзжрззрзирзйрзкрзлрзмрзнрзорзп"[d]);

  try{
    const r = await fetch('/api/panchika');
    const j = await r.json();

    // Sun/Moon (already 12h from API)
    document.getElementById('sunrise').textContent = bnDigits(j.sunrise||'тАФ');
    document.getElementById('sunset').textContent  = bnDigits(j.sunset||'тАФ');
    document.getElementById('moonrise').textContent= bnDigits(j.moonrise||'тАФ');
    document.getElementById('moonset').textContent = bnDigits(j.moonset||'тАФ');

    // Tithi/Nakshatra (placeholders right now; will be filled next)
    const t = j.tithi || {};
    const n = j.nakshatra || {};
    document.getElementById('tithi').textContent = t.current || 'тАФ';
    document.getElementById('tithiExtra').textContent =
      (t.ends_at ? `рж╢рзЗрж╖: ${bnDigits(t.ends_at)}` : '') +
      (t.next ? ` тАв ржкрж░ржмрж░рзНрждрзА: ${t.next}` : '');
    document.getElementById('nak').textContent = n.current || 'тАФ';
    document.getElementById('nakExtra').textContent =
      (n.ends_at ? `рж╢рзЗрж╖: ${bnDigits(n.ends_at)}` : '') +
      (n.next ? ` тАв ржкрж░ржмрж░рзНрждрзА: ${n.next}` : '');

    // Ekadashi
    const e = j.ekadashi || {};
    document.getElementById('ekaName').textContent = e.name || 'тАФ';
    document.getElementById('ekaDate').textContent = e.date ? bnDigits(e.date.replace(/-/g,'-')) : 'тАФ';
    document.getElementById('ekaLeft').textContent = e.days_left!=null ? `${bnDigits(e.days_left)} ржжрж┐ржи ржмрж╛ржХрж┐` : 'тАФ';

    // Tide (placeholders now)
    if (Array.isArray(j.tide)){
      const safe = (i) => (j.tide[i] && j.tide[i].time) ? j.tide[i].time : 'тАФ';
      document.getElementById('tide1').textContent = bnDigits(safe(0));
      document.getElementById('tide2').textContent = bnDigits(safe(1));
      document.getElementById('tide3').textContent = bnDigits(safe(2));
      document.getElementById('tide4').textContent = bnDigits(safe(3));
    }
  }catch(e){
    console.error(e);
  }
})();
</script>
</body>
</html>
